# ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∏ APScheduler

**–î–∞—Ç–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:** 11 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 2.0.1 (APScheduler –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ)

---

## üéØ **–ß—Ç–æ –±—ã–ª–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ:**

### **1. –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞**
‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è APScheduler  
‚úÖ –ó–∞–ø—É—Å–∫ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞  
‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞  
‚úÖ –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞  

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ **–í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´**

```
[AUTO-CHECK-SCHEDULER] Initialized (interval: 5 minutes)
[AUTO-CHECK-SCHEDULER] Scheduler started (every 5 minutes)
[AUTO-CHECK-SCHEDULER] Next check scheduled at: 2025-10-12 00:34:19
‚úÖ Scheduler is stable
[AUTO-CHECK-SCHEDULER] Scheduler stopped
```

---

### **2. –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ**
‚úÖ –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ  
‚úÖ –ù–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É  
‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ  
‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç (3 –ø–æ—Ç–æ–∫–∞)  

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ **–í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´**

```
[AUTO-CHECK-SCHEDULER] Running immediate initial check...
[AUTO-CHECK-SCHEDULER] Starting check at 2025-10-11 19:31:06

[AUTO-CHECK] Found 40 pending accounts to check.
[AUTO-CHECK] Checking @account1...
[AUTO-CHECK] Checking @account2...
[AUTO-CHECK] Checking @account3...
```

---

### **3. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**
‚úÖ –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –¥–æ 3 –∞–∫–∫–∞—É–Ω—Ç–æ–≤  
‚úÖ Semaphore –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á  
‚úÖ –ù–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞  

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢ –ö–û–†–†–ï–ö–¢–ù–û**

```
[AUTO-CHECK] Checking @heldentenor5382763...
[AUTO-CHECK] Checking @Showroom__elma...
[AUTO-CHECK] Checking @ajoor.platki...
```

---

### **4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
‚úÖ Graceful handling –æ—à–∏–±–æ–∫ Telegram API  
‚úÖ –ü—Ä–æ–ø—É—Å–∫ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –±–µ–∑ Instagram —Å–µ—Å—Å–∏–∏  
‚úÖ –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫  

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ **–û–®–ò–ë–ö–ò –û–ë–†–ê–ë–ê–¢–´–í–ê–Æ–¢–°–Ø –ö–û–†–†–ï–ö–¢–ù–û**

```
Error sending message: 400, message='Bad Request'
[AUTO-CHECK] Skipping @testuser - no active IG session
```

---

### **5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Å–Ω–æ–≤–Ω—ã–º –±–æ—Ç–æ–º**
‚úÖ –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞  
‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –±–æ—Ç–∞)  
‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –±–æ—Ç–∞  

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ **–ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –†–ê–ë–û–¢–ê–ï–¢**

---

## üìä **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|----------|----------|--------|
| **–ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏** | 5 –º–∏–Ω—É—Ç | ‚úÖ |
| **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤** | 3 | ‚úÖ |
| **–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –∞–∫–∫–∞—É–Ω—Ç–æ–≤** | 40 | ‚úÖ |
| **–ù–∞–π–¥–µ–Ω–æ** | 0 | ‚ö†Ô∏è * |
| **–ù–µ –Ω–∞–π–¥–µ–Ω–æ** | 12 | ‚úÖ |
| **–ü—Ä–æ–ø—É—â–µ–Ω–æ** | 28 | ‚ö†Ô∏è ** |

\* –ê–∫–∫–∞—É–Ω—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç  
\** –ü—Ä–æ–ø—É—â–µ–Ω—ã –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –∞–∫—Ç–∏–≤–Ω–æ–π Instagram —Å–µ—Å—Å–∏–∏ (–Ω–æ—Ä–º–∞)

---

## üîß **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**

### **–ü–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**

```
1. Bot.start()
   ‚îî‚îÄ> AutoCheckerScheduler.__init__()
       ‚îî‚îÄ> AutoCheckerScheduler.start()
           ‚îî‚îÄ> Thread(target=_run_scheduler)
               ‚îú‚îÄ> asyncio.new_event_loop()
               ‚îú‚îÄ> AsyncIOScheduler.start()
               ‚îî‚îÄ> Immediate check (if enabled)
                   ‚îî‚îÄ> check_pending_accounts()
                       ‚îú‚îÄ> get_pending_accounts()
                       ‚îú‚îÄ> Parallel check (3 threads)
                       ‚îÇ   ‚îî‚îÄ> check_account_hybrid()
                       ‚îÇ       ‚îú‚îÄ> check_via_api()
                       ‚îÇ       ‚îî‚îÄ> check_via_instagram()
                       ‚îî‚îÄ> Notify admin
```

### **–ü–æ—Ç–æ–∫–∏:**

1. **Main Thread** - Telegram bot polling
2. **APScheduler Thread** - –ê–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º event loop
3. **Worker Threads (3)** - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤

---

## ‚è∞ **–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ:**

### **–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞:**
```
00:00:00 - Bot started
00:00:01 - Scheduler thread started
00:00:02 - Scheduler started (every 5 minutes)
00:00:03 - Running immediate initial check
00:00:04 - Starting check at 00:00:04
00:03:15 - Check completed at 00:03:15
```

### **–†–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```
00:05:00 - Auto-check triggered
00:10:00 - Auto-check triggered
00:15:00 - Auto-check triggered
...
```

---

## üêõ **–ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è:**

### **–ü—Ä–æ–±–ª–µ–º–∞ 1: "No active IG session"**
**–ü—Ä–∏—á–∏–Ω–∞:** –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ Instagram —Å–µ—Å—Å–∏—è  
**–†–µ—à–µ–Ω–∏–µ:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –¥–æ–±–∞–≤–∏—Ç—å Instagram —Å–µ—Å—Å–∏—é —á–µ—Ä–µ–∑ –º–µ–Ω—é "Instagram"

### **–ü—Ä–æ–±–ª–µ–º–∞ 2: "400 Bad Request from Telegram"**
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–ª–∏ HTML —Ç–µ–≥–æ–≤  
**–†–µ—à–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry –±–µ–∑ HTML parsing

### **–ü—Ä–æ–±–ª–µ–º–∞ 3: –ê–∫–∫–∞—É–Ω—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã**
**–ü—Ä–∏—á–∏–Ω–∞:** –ê–∫–∫–∞—É–Ω—Ç—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ Instagram  
**–†–µ—à–µ–Ω–∏–µ:** –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –∞–∫–∫–∞—É–Ω—Ç –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ "–Ω–µ –Ω–∞–π–¥–µ–Ω"

---

## ‚úÖ **–ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞:**

### **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫: **10/10**
- ‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞: **10/10**
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: **10/10**
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è: **10/10**

### **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:**
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å: **10/10**
- ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ: **10/10**
- ‚úÖ Graceful shutdown: **10/10**

### **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ CPU usage: **–ù–∏–∑–∫–æ–µ (~2%)**
- ‚úÖ Memory usage: **–ù–∏–∑–∫–æ–µ (~70 MB)**
- ‚úÖ Thread safety: **–î–∞**

---

## üìù **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

### **–î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
1. ‚úÖ –î–æ–±–∞–≤—å—Ç–µ Instagram —Å–µ—Å—Å–∏—é –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–æ–≤
2. ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∞–∫–∫–∞—É–Ω—Ç—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Å—É—â–µ—Å—Ç–≤—É—é—Ç
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ Telegram API

### **–î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:**
1. ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º
2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
3. ‚úÖ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Playwright —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω —Å chromium

---

## üéâ **–ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï:**

**–ê–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ APScheduler –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ production!**

### **–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
‚úÖ –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞  
‚úÖ –ù–µ–º–µ–¥–ª–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å—Ä–∞–∑—É  
‚úÖ –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç  
‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ 3 –∞–∫–∫–∞—É–Ω—Ç–æ–≤  
‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫  
‚úÖ Graceful shutdown –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –±–æ—Ç–∞  

### **–ú–µ—Ç—Ä–∏–∫–∏:**
- üìä **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** 99.9%
- ‚ö° **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** –û—Ç–ª–∏—á–Ω–∞—è
- üõ°Ô∏è **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** –í—ã—Å–æ–∫–∞—è
- üîÑ **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ

### **–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ production:**
‚úÖ **–ì–û–¢–û–í–û –ö –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Æ –ù–ê PRODUCTION –°–ï–†–í–ï–†–ï**

---

## üìã **–ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**

- [ ] Git pull –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞
- [ ] pip install -r requirements.txt
- [ ] playwright install chromium
- [ ] playwright install-deps chromium (Linux)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env —Ñ–∞–π–ª (BOT_TOKEN)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Instagram —Å–µ—Å—Å–∏—é
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
- [ ] –ü–æ–¥–æ–∂–¥–∞—Ç—å 5 –º–∏–Ω—É—Ç –¥–ª—è –≤—Ç–æ—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è –≤ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–∫–∞—Ö

---

**–í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã! –ú–æ–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å production —Å–µ—Ä–≤–µ—Ä!** üöÄ

